\usepackage{xeCJK}
%中文支持包

\setCJKmainfont{Microsoft YaHei}  
% 设置默认中文字体是微软雅黑

\setmainfont{Consolas} 
%设置默认的英文字体

\setCJKfamilyfont{kai}{KaiTi}         %定义楷体的字体族代号： kai    
\newcommand{\kai}{\CJKfamily{kai}}    %宏定义kai体命令： \kai{}
%代码中使用： \kai{}  与  \CJKfamily{kai}  是一样的

\setCJKfamilyfont{song}{SimSun}		  %定义宋体的字体族代号： song
\newcommand{\song}{\CJKfamily{song}}  %宏定义song体

\setCJKfamilyfont{Yahei}{Microsoft YaHei}
\newcommand{\Yahei}{\CJKfamily{Yahei}}

%%%%%%%%%%%%%%%%%%%%%%%%%% 以上是字体部分 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{geometry}
\geometry{a4paper, centering , scale=0.8} 			% a4纸， 居中， 占页面80%
%\geometry{left=1cm,right=2cm,top=3cm,bottom=4cm} 	% 页边距



\usepackage{fancyhdr}				 % 页眉页脚
	\pagestyle{fancy}
	\lhead{ }
	\chead{ }
	\rhead{ $L^AT_EX$ }
	\lfoot{}
	\cfoot{\thepage}
	\rfoot{}
	\renewcommand{\headrulewidth}{0pt}           %页眉与正文分割线的粗细
	\renewcommand{\headwidth}{\textwidth}
	\renewcommand{\footrulewidth}{0pt}
%%%%%%%%%%%%%%%%%%%%%%%%%% 以上是页面设置部分 %%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{listings}    % 插入代码

\lstset{ 
	backgroundcolor=\color{mybackground},   				% choose the background color	
	basicstyle=\footnotesize\color{white},       				% size of fonts used for the code
	numbers=left, 											% 行号加在左边还是有边
	numberstyle=\tiny\color{black},										% 行号的字体设定
	columns=fullflexible,
 	breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace	
	breaklines=true,                				% automatic line breaking only at whitespace 自动换行
	captionpos=b,                    				% sets the caption-position to bottom
	keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)	
	rulecolor=\color{green}, 			
	 showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
	  showstringspaces=false,          % underline spaces within strings only	
	tabsize=4,
	commentstyle=\color{green},   				% comment style
	escapeinside={\%*}{*)},         				% if you want to add LaTeX within your code
	keywordstyle=\color{green},       				% keyword style
	stringstyle=\color{mymauve},     		% string literal style
%	frame=shadowbox,
	frame=single,
	rulesepcolor=\color{red!20!green!20!blue!20},
	% identifierstyle=\color{red},	
	language=[LaTeX]TeX,
	title=\lstname
}

%%%%%%%%%%%%%%%%%%%%%%%%%% 以上是插入代码设置部分 %%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{colortbl}
\usepackage{xcolor}

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mymauve}{rgb}{0.58,0,0.82}
\definecolor{mygray}{gray}{.9}
\definecolor{mypink}{rgb}{.99,.91,.95}
\definecolor{mybackground}{RGB}{45,45,45}

%%%%%%%%%%%%%%%%%%%%%%%%%% 以上是颜色设置部分 %%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{graphicx}   % 插图片
\usepackage{makeidx}   
\usepackage{float}
\usepackage{amsmath}    % 数学公式包
\usepackage{amssymb}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{setspace}
\usepackage{fontspec}
\usepackage{lipsum}

%%%%%%%%%%%%%%%%%%%%%%%%%% 其余会用到的包 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% 画图
%\usepackage{tikz}
%\usetikzlibrary{matrix,arrows,shapes,chains}
\usepackage[explicit]{titlesec}
% 衬线字体
%\usepackage{charter}

\definecolor{mybluei}{RGB}{20, 0, 100}
\definecolor{myblueii}{RGB}{0, 0, 100}
\usepackage{rotating, graphicx}

\usepackage{tcolorbox}
\newcommand\ChapterFont{\rmfamily\selectfont\huge}
\newcommand\SectionFont{\bfseries\rmfamily\selectfont\Large}

%chapter
\titleformat{\chapter}[block]
 {\normalfont\ChapterFont\huge\color{myblueii}} 
 {\tcbset{colframe=mybluei, boxrule=0.8pt, left=0pt, right=0pt, top=0pt, bottom=0pt}
  \raisebox{-0.48\height}{\rotatebox{90}{\tcbox[boxsep=4pt, colback= white ]{\color{mybluei}\Large Paladnix}}}
  \hskip 0.25em
  \mbox{\tcbox[ boxsep=12pt, colback=mybluei, tcbox raise = -35pt]{\color{white}\bfseries\fontsize{70}{70}\selectfont\thechapter}}}
 {0.5em}
 {#1\vskip0.6ex\endgraf\titlerule[1ex]}
 []

%section
 \titleformat{\section}
 {\normalfont\small\sffamily\SectionFont\color{myblueii}}
 {\colorbox{mybluei}{%
        \parbox[c][28pt][c]{40pt}{%
            \centering\textcolor{white}{\SectionFont\Large\rmfamily\thesection}%
        }%
    }%
 }
 {1em}
 {#1}
 [\vspace{-0.755\baselineskip}%
 \color{myblueii}\hspace*{\dimexpr40pt+2\fboxsep\relax}%
 \rule{\dimexpr\textwidth-40pt-2\fboxsep\relax}{1pt}%
 ]
 
% subsection 
 \titleformat{\subsection}
 {\normalfont\small\sffamily\SectionFont\color{myblueii}}
 {\colorbox{mybluei}{%
        \parbox[c][16pt][c]{50pt}{%
            \centering\textcolor{white}{\SectionFont\Large\rmfamily\thesubsection}%
        }%
    }%
 }
 {1em}
 {#1}
 [\vspace{-0.755\baselineskip}%
 \color{myblueii}\hspace*{\dimexpr40pt+2\fboxsep\relax}%
 \rule{\dimexpr\textwidth-40pt-2\fboxsep\relax}{0pt}%
 ]

%%%%%%%%%%%%%%%%%%%%%%%%%% 定制章节头 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%